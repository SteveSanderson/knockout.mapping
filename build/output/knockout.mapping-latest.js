/// Knockout Mapping plugin v2.4.1
/// (c) 2013 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
/// License: MIT (http://www.opensource.org/licenses/mit-license.php)
(function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("knockout"),exports):typeof define=="function"&&define.amd?define(["knockout","exports"],n):n(ko,ko.mapping={})})(function(n,t){function rt(){for(var r=arguments,u=r.length,f={},e=[],t,n,i;u--;)for(i=r[u],t=i.length;t--;)n=i[t],f[n]||(f[n]=1,e.push(n));return e}function y(n,i){var u,r,f;for(r in i)i.hasOwnProperty(r)&&i[r]&&(u=t.getType(n[r]),r&&n[r]&&u!=="array"&&u!=="string"?y(n[r],i[r]):(f=t.getType(n[r])==="array"&&t.getType(i[r])==="array",n[r]=f?rt(n[r],i[r]):i[r]))}function h(n,t){var i={};return y(i,n),y(i,t),i}function p(n,t){for(var f,i=h({},n),e=w.length-1;e>=0;e--)(f=w[e],i[f])&&(i[""]instanceof Object||(i[""]={}),i[""][f]=i[f],delete i[f]);return t&&(i.ignore=u(t.ignore,i.ignore),i.include=u(t.include,i.include),i.copy=u(t.copy,i.copy),i.observe=u(t.observe,i.observe)),i.ignore=u(i.ignore,r.ignore),i.include=u(i.include,r.include),i.copy=u(i.copy,r.copy),i.observe=u(i.observe,r.observe),i.mappedProperties=i.mappedProperties||{},i.copiedProperties=i.copiedProperties||{},i}function u(i,r){return t.getType(i)!=="array"&&(i=t.getType(i)==="undefined"?[]:[i]),t.getType(r)!=="array"&&(r=t.getType(r)==="undefined"?[]:[r]),n.utils.arrayGetDistinctValues(i.concat(r))}function ut(t,i){var u=n.dependentObservable,r;return n.dependentObservable=function(i,r,u){var f;u=u||{};i&&typeof i=="object"&&(u=i);var s=u.deferEvaluation,o=!1,h=function(i){var f=n.dependentObservable,u,r;return n.dependentObservable=e,u=n.isWriteableObservable(i),n.dependentObservable=f,r=e({read:function(){return o||(n.utils.arrayRemoveItem(t,i),o=!0),i.apply(i,arguments)},write:u&&function(n){return i(n)},deferEvaluation:!0}),it&&(r._wrapper=!0),r.__DO=i,r};return u.deferEvaluation=!0,f=new e(i,r,u),s||(f=h(f),t.push(f)),f},n.dependentObservable.fn=e.fn,n.computed=n.dependentObservable,r=i(),n.dependentObservable=u,n.computed=n.dependentObservable,r}function c(r,u,f,e,v,y,p){var oi=t.getType(n.utils.unwrapObservable(u))==="array",ni,ot,ii,lt,d,it,gt,st,ht;y=y||"";t.isMapped(r)&&(ni=n.utils.unwrapObservable(r)[i],f=h(ni,f));var et={data:u,parent:p||v},ct=function(){return f[e]&&f[e].create instanceof Function},yt=function(t){return ut(o,function(){return n.utils.unwrapObservable(v)instanceof Array?f[e].create({data:t||et.data,parent:et.parent,skip:b}):f[e].create({data:t||et.data,parent:et.parent})})},rt=function(){return f[e]&&f[e].update instanceof Function},ft=function(t,i){var r={data:i||et.data,parent:et.parent,target:n.utils.unwrapObservable(t)};return n.isWriteableObservable(t)&&(r.observable=t),f[e].update(r)},ti=s.get(u);if(ti)return ti;if(e=e||"",oi){var ri=[],ui=!1,w=function(n){return n};f[e]&&f[e].key&&(w=f[e].key,ui=!0);n.isObservable(r)||(r=n.observableArray([]),r.mappedRemove=function(n){var t=typeof n=="function"?n:function(t){return t===w(n)};return r.remove(function(n){return t(w(n))})},r.mappedRemoveAll=function(t){var i=a(t,w);return r.remove(function(t){return n.utils.arrayIndexOf(i,w(t))!=-1})},r.mappedDestroy=function(n){var t=typeof n=="function"?n:function(t){return t===w(n)};return r.destroy(function(n){return t(w(n))})},r.mappedDestroyAll=function(t){var i=a(t,w);return r.destroy(function(t){return n.utils.arrayIndexOf(i,w(t))!=-1})},r.mappedIndexOf=function(t){var i=a(r(),w),u=w(t);return n.utils.arrayIndexOf(i,u)},r.mappedGet=function(n){return r()[r.mappedIndexOf(n)]},r.mappedCreate=function(t){var i,u;if(r.mappedIndexOf(t)!==-1)throw new Error("There already is an object with the key that you specified.");return i=ct()?yt(t):t,rt()&&(u=ft(i,t),n.isWriteableObservable(i)?i(u):i=u),r.push(i),i});for(var si=a(n.utils.unwrapObservable(r),w).sort(),pt=[],at={},wt=n.utils.unwrapObservable(u),bt={},kt=!0,tt=0,vt=wt.length;tt<vt;tt++){if(d=w(wt[tt]),pt.push(d),d===undefined||d instanceof Object){kt=!1;break}bt[d]=wt[tt]}ui&&pt.sort();var fi=n.utils.compareArrays(si,pt),dt=[],ei=0;for(tt=0,vt=fi.length;tt<vt;tt++){d=fi[tt];gt=y+"["+tt+"]";switch(d.status){case"added":st=kt?bt[d.value]:l(n.utils.unwrapObservable(u),d.value,w);it=c(undefined,st,f,e,r,gt,v);ct()||(it=n.utils.unwrapObservable(it));ht=k(n.utils.unwrapObservable(u),st,at);it===b?ei++:dt[ht-ei]=it;at[ht]=!0;break;case"retained":st=kt?bt[d.value]:l(n.utils.unwrapObservable(u),d.value,w);it=l(r,d.value,w);c(it,st,f,e,r,gt,v);ht=k(n.utils.unwrapObservable(u),st,at);dt[ht]=it;at[ht]=!0;break;case"deleted":it=l(r,d.value,w)}ri.push({event:d.status,item:it})}r(dt);f[e]&&f[e].arrayChanged&&n.utils.arrayForEach(ri,function(n){f[e].arrayChanged(n.event,n.item)})}else if(nt(u)){if(r=n.utils.unwrapObservable(r),!r){if(ct())return lt=yt(),rt()&&(lt=ft(lt)),lt;if(rt())return ft(lt);r={}}if(rt()&&(r=ft(r)),s.save(u,r),rt())return r;g(u,function(t){var i=y.length?y+"."+t:t;if(!n.utils.arrayFirst(f.ignore,function(n){return n.test instanceof Function?n.test(i):i===n})){if(n.utils.arrayFirst(f.copy,function(n){return n.test instanceof Function?n.test(i):i===n})){r[t]=u[t];return}if(typeof u[t]!="object"&&typeof u[t]!="array"&&f.observe.length>0&&!n.utils.arrayFirst(f.observe,function(n){return n.test instanceof Function?n.test(i):i===n})){r[t]=u[t];f.copiedProperties[i]=!0;return}var o=s.get(u[t]),h=c(r[t],u[t],f,t,r,i,r),e=o||h;if(f.observe.length>0&&!n.utils.arrayFirst(f.observe,function(n){return n.test instanceof Function?n.test(i):i===n})){r[t]=n.utils.unwrapObservable(e);f.copiedProperties[i]=!0;return}n.isWriteableObservable(r[t])?(e=n.utils.unwrapObservable(e),r[t]()!==e&&r[t](e)):(e=r[t]===undefined?e:n.utils.unwrapObservable(e),r[t]=e);f.mappedProperties[i]=!0}})}else switch(t.getType(u)){case"function":rt()?n.isWriteableObservable(u)?(u(ft(u)),r=u):r=ft(u):r=u;break;default:if(n.isWriteableObservable(r))return rt()?(ot=ft(r),r(ot),ot):(ot=n.utils.unwrapObservable(u),r(ot),ot);if(ii=ct()||rt(),r=ct()?yt():n.observable(n.utils.unwrapObservable(u)),rt()&&r(ft(r)),ii)return r}return r}function k(n,t,i){for(var r=0,u=n.length;r<u;r++)if(i[r]!==!0&&n[r]===t)return r;return null}function d(i,r){var u;return r&&(u=r(i)),t.getType(u)==="undefined"&&(u=i),n.utils.unwrapObservable(u)}function l(t,i,r){var u,e,f;for(t=n.utils.unwrapObservable(t),u=0,e=t.length;u<e;u++)if(f=t[u],d(f,r)===i)return f;throw new Error("When calling ko.update*, the key '"+i+"' was not found!");}function a(t,i){return n.utils.arrayMap(n.utils.unwrapObservable(t),function(n){return i?d(n,i):n})}function g(n,i){var r,u;if(t.getType(n)==="array")for(r=0;r<n.length;r++)i(r);else for(u in n)i(u)}function nt(n){var i=t.getType(n);return(i==="object"||i==="array")&&n!==null}function ft(n,i,r){var u=n||"";return t.getType(i)==="array"?n&&(u+="["+r+"]"):(n&&(u+="."),u+=r),u}function et(){var t=[],i=[];this.save=function(r,u){var f=n.utils.arrayIndexOf(t,r);f>=0?i[f]=u:(t.push(r),i.push(u))};this.get=function(r){var u=n.utils.arrayIndexOf(t,r);return u>=0?i[u]:undefined}}function tt(){var n={},t=function(t){var r,i;try{r={__ko_mapping_key__:t}}catch(u){r={__ko_mapping_key__:"$$$"}}return i=n[r],i===undefined&&(i=new et,n[r]=i),i};this.save=function(n,i){t(n).save(n,i)};this.get=function(n){return t(n).get(n)}}var it=!0,i="__ko_mapping__",e=n.dependentObservable,v=0,o,s,w=["create","update","key","arrayChanged"],b={},f={include:["_destroy"],ignore:[],copy:[],observe:[]},r=f;t.isMapped=function(t){var r=n.utils.unwrapObservable(t);return r&&r[i]};t.fromJS=function(n){var t,r,u,f;if(arguments.length==0)throw new Error("When calling ko.fromJS, pass the object you want to convert.");try{if(v++||(o=[],s=new tt),arguments.length==2&&(arguments[1][i]?r=arguments[1]:t=arguments[1]),arguments.length==3&&(t=arguments[1],r=arguments[2]),r&&(t=h(t,r[i])),t=p(t),u=c(r,n,t),r&&(u=r),!--v)while(o.length)f=o.pop(),f&&(f(),f.__DO.throttleEvaluation=f.throttleEvaluation);return u[i]=h(u[i],t),u}catch(e){v=0;throw e;}};t.fromJSON=function(i){var r=n.utils.parseJson(i);return arguments[0]=r,t.fromJS.apply(this,arguments)};t.updateFromJS=function(){throw new Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!");};t.updateFromJSON=function(){throw new Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!");};t.toJS=function(u,f){if(r||t.resetDefaultOptions(),arguments.length==0)throw new Error("When calling ko.mapping.toJS, pass the object you want to convert.");if(t.getType(r.ignore)!=="array")throw new Error("ko.mapping.defaultOptions().ignore should be an array.");if(t.getType(r.include)!=="array")throw new Error("ko.mapping.defaultOptions().include should be an array.");if(t.getType(r.copy)!=="array")throw new Error("ko.mapping.defaultOptions().copy should be an array.");return f=p(f,u[i]),t.visitModel(u,function(t){return n.utils.unwrapObservable(t)},f)};t.toJSON=function(i,r){var u=t.toJS(i,r);return n.utils.stringifyJson(u)};t.defaultOptions=function(){if(arguments.length>0)r=arguments[0];else return r};t.resetDefaultOptions=function(){r={include:f.include.slice(0),ignore:f.ignore.slice(0),copy:f.copy.slice(0),observe:f.observe.slice(0)}};t.getType=function(n){if(n&&typeof n=="object"){if(n.constructor===Date)return"date";if(n.constructor===Array)return"array"}return typeof n};t.visitModel=function(r,u,f){var o,e,s;if(f=f||{},f.visitedObjects=f.visitedObjects||new tt,e=n.utils.unwrapObservable(r),nt(e))f=p(f,e[i]),u(r,f.parentName),o=t.getType(e)==="array"?[]:{};else return u(r,f.parentName);return f.visitedObjects.save(r,o),s=f.parentName,g(e,function(r){var h,c;if((!f.ignore||n.utils.arrayIndexOf(f.ignore,r)==-1)&&(h=e[r],f.parentName=ft(s,e,r),n.utils.arrayIndexOf(f.copy,r)!==-1||n.utils.arrayIndexOf(f.include,r)!==-1||!e[i]||!e[i].mappedProperties||e[i].mappedProperties[r]||!e[i].copiedProperties||e[i].copiedProperties[r]||t.getType(e)==="array"))switch(t.getType(n.utils.unwrapObservable(h))){case"object":case"array":case"undefined":c=f.visitedObjects.get(h);o[r]=t.getType(c)!=="undefined"?c:t.visitModel(h,u,f);break;default:o[r]=u(h,f.parentName)}}),o}});
